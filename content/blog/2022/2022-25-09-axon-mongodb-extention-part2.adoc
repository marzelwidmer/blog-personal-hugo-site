---
author: "Marcel Widmer"
date : "2022-09-25"
title: Axon Framework with MongoDB extension and Onion Architecture - Part 2
description: "AxonIQ - Spring Boot - MongoDB extension - CQRS"
tags: [Spring Boot, Axon, CQRS]
categories: [Development]
ShowToc: true
TocOpen: true
---

= HATEOAS
== Index Root Controller


[source,kotlin]
.index root controller
----
echo "
package ch.keepcalm.demo.infrastructure.api

import kotlinx.coroutines.reactive.awaitSingle
import org.springframework.hateoas.EntityModel
import org.springframework.hateoas.Link
import org.springframework.hateoas.MediaTypes
import org.springframework.hateoas.config.EnableHypermediaSupport
import org.springframework.hateoas.server.reactive.WebFluxLinkBuilder.linkTo
import org.springframework.hateoas.server.reactive.WebFluxLinkBuilder.methodOn
import org.springframework.hateoas.support.WebStack
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

@RestController
@RequestMapping(produces = [MediaTypes.HAL_JSON_VALUE])
@EnableHypermediaSupport(stacks = [WebStack.WEBFLUX], type = [EnableHypermediaSupport.HypermediaType.HAL])
class IndexRootController() {
    companion object REL {
        const val REL_SPRING_INITIALIZR = \"start-spring\"
    }

    @GetMapping(\"/\")
    suspend fun index(): EntityModel<Unit> {
        return EntityModel.of(Unit, linkTo(methodOn(IndexRootController::class.java).index()).withSelfRel().toMono().awaitSingle())
            .add(Link.of(\"https://start.spring.io\").withRel(REL_SPRING_INITIALIZR))
    }
}
" | > src/main/kotlin/ch/keepcalm/demo/infrastructure/api/IndexRootController.kt
----


[source,bash]
.Start SpringBoot application with standalone profile
----
SPRING_PROFILES_ACTIVE=standalone mvn clean spring-boot:run -Pstandalone
----


[source,bash]
.Test IndexRootController API with httpie
----
http :8080

HTTP/1.1 200 OK
Content-Length: 103
Content-Type: application/hal+json

{
    "_links": {
        "self": {
            "href": "http://localhost:8080/"
        },
        "start-spring": {
            "href": "https://start.spring.io"
        }
    }
}
----





